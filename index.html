<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Bi-Weekly Timesheet â€“ 2026</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body { font-family: Arial, sans-serif; background:#f4f4f4; padding:20px; }
    .sheet-container {
      max-width: 900px;
      margin: 0 auto;
      background: #fff;
      padding: 20px 24px 30px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,.1);
    }
    .logo-row { text-align:center; margin-bottom:8px; }
    .logo-row img { max-height:70px; }
    h1 { text-align:center; margin:6px 0 12px; }

    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th, td { border:1px solid #ccc; padding:6px 8px; font-size:14px; }
    th { background:#e8e8e8; }

    .no-border td { border:none; padding:4px; }

    input, select {
      width:100%;
      box-sizing:border-box;
      border:1px solid #ccc;
      border-radius:3px;
      padding:4px;
      font-size:13px;
    }

    input[readonly] { background:#f7f7f7; }

    .total-row td { font-weight:bold; background:#fafafa; }

    .buttons {
      margin-top:15px;
      display:flex;
      gap:10px;
      justify-content:flex-end;
    }

    button {
      padding:8px 16px;
      border-radius:4px;
      border:none;
      cursor:pointer;
      font-size:14px;
    }

    .btn-print { background:#777; color:#fff; }
    .btn-submit { background:#0073e6; color:#fff; }

    /* Login */
    .login-box { text-align:center; }
    .login-inputs { max-width:340px; margin:0 auto; text-align:left; }
    .login-inputs label { display:block; margin-top:8px; }
    .login-buttons { margin-top:12px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap; }
    .login-message { margin-top:10px; min-height:18px; color:#b00020; }
    .user-email { margin-top:6px; font-size:13px; color:#333; }

    @media print {
      .buttons { display:none; }
      body { background:#fff; }
      .sheet-container { box-shadow:none; }
      #loginContainer { display:none !important; }
    }
  </style>
</head>

<body>

<!-- LOGIN -->
<div id="loginContainer" class="sheet-container">
  <div class="login-box">
    <h2>Timesheet Login</h2>
    <p>Access is restricted to approved users.</p>

    <div class="login-inputs">
      <label>Email</label>
      <input type="email" id="loginEmail" placeholder="you@example.com" />
      <label>Password</label>
      <input type="password" id="loginPassword" />
    </div>

    <div class="login-buttons">
      <button id="signUpBtn">Sign up</button>
      <button id="loginBtn">Log in</button>
      <button id="signOutBtn" style="display:none;">Sign out</button>
    </div>

    <div id="loginMessage" class="login-message"></div>
    <div id="loggedInInfo" class="user-email"></div>
  </div>
</div>

<!-- TIMESHEET -->
<div id="timesheetContainer" class="sheet-container" style="display:none;">
  <div class="logo-row">
    <img src="logo.png" alt="Logo">
  </div>

  <h1>Bi-Weekly Timesheet â€“ 2026</h1>

  <table class="no-border">
    <tr>
      <td><strong>Period</strong></td>
      <td>
        <select id="weekPeriod"></select>
      </td>
      <td><strong>Send To</strong></td>
      <td><input id="recipientEmail" type="email"></td>
    </tr>
    <tr>
      <td><strong>School</strong></td>
      <td><input id="schoolName"></td>
      <td><strong>Supervisor Email</strong></td>
      <td><input id="supervisorEmail"></td>
    </tr>
    <tr>
      <td><strong>Employee</strong></td>
      <td><input id="employeeName"></td>
      <td><strong>Title</strong></td>
      <td><input id="employeeTitle"></td>
    </tr>
    <tr>
      <td><strong>Supervisor</strong></td>
      <td><input id="supervisorName"></td>
      <td></td><td></td>
    </tr>
  </table>

  <table>
    <thead>
      <tr>
        <th>Date (Weekday)</th>
        <th>Time In</th>
        <th>Time Out</th>
        <th>Lunch (min)</th>
        <th>Hours</th>
      </tr>
    </thead>
    <tbody id="timesheetBody"></tbody>
    <tfoot>
      <tr class="total-row">
        <td>Total</td><td></td><td></td><td></td>
        <td id="totalHours">0.00</td>
      </tr>
    </tfoot>
  </table>

  <div class="buttons">
    <button class="btn-print" onclick="window.print()">Print</button>
    <button class="btn-submit" onclick="submitTimesheet()">Submit</button>
  </div>
</div>

<!-- FIREBASE SDK (compat) -->
<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-auth-compat.js"></script>

<script>
/* ================= CONFIG ================= */

const SCRIPT_URL =
"https://script.google.com/macros/s/AKfycbxZHjAz7akkH0E4SPQmHppIMi-A_orkvNeNX-8ElaW83bSZrGJe4erliwVEVR8rRNlr/exec";

/* ðŸ”¥ YOUR FIREBASE CONFIG â€” already replaced */
const firebaseConfig = {
  apiKey: "AIzaSyDn4kef3XjyJiDgXnD8ZLRO_-q3c7467pA",
  authDomain: "timesheet360-92220.firebaseapp.com",
  projectId: "timesheet360-92220",
  storageBucket: "timesheet360-92220.appspot.com",
  messagingSenderId: "526532359738",
  appId: "1:526532359738:web:881ddbe435d0ea5942e703"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

/* ================= AUTH ================= */

async function isAllowed(email) {
  const res = await fetch(
    SCRIPT_URL + "?action=isAllowed&email=" + encodeURIComponent(email)
  );
  const data = await res.json();
  return data.allowed === true;
}

function msg(text) {
  document.getElementById("loginMessage").textContent = text;
}

document.getElementById("signUpBtn").onclick = async () => {
  const email = loginEmail.value.toLowerCase();
  const pass  = loginPassword.value;
  if (!(await isAllowed(email))) return msg("Not authorized.");
  await auth.createUserWithEmailAndPassword(email, pass);
};

document.getElementById("loginBtn").onclick = async () => {
  await auth.signInWithEmailAndPassword(loginEmail.value, loginPassword.value);
};

document.getElementById("signOutBtn").onclick = () => auth.signOut();

auth.onAuthStateChanged(async user => {
  if (!user) {
    loginContainer.style.display = "block";
    timesheetContainer.style.display = "none";
    return;
  }
  if (!(await isAllowed(user.email))) {
    await auth.signOut();
    msg("Not authorized.");
    return;
  }
  loggedInInfo.textContent = "Logged in as " + user.email;
  loginContainer.style.display = "none";
  timesheetContainer.style.display = "block";
  buildPeriods();
  populateDays();
});

/* ================= TIMESHEET ================= */

const YEAR = 2026;
const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
const days = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];

function buildPeriods() {
  weekPeriod.innerHTML = "";
  months.forEach((m,i)=>{
    weekPeriod.add(new Option(`${m} 1st Half`,`${i}-1`));
    weekPeriod.add(new Option(`${m} 2nd Half`,`${i}-2`));
  });
}

function populateDays() {
  timesheetBody.innerHTML = "";
  const [m,h] = weekPeriod.value.split("-").map(Number);
  const max = new Date(YEAR,m+1,0).getDate();
  const start = h===1?1:16;
  const end   = h===1?15:max;

  for(let d=start; d<=end; d++){
    const dt = new Date(YEAR,m,d);
    if (dt.getDay()===0 || dt.getDay()===6) continue;

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${days[dt.getDay()]}, ${months[m]} ${d}, ${YEAR}</td>
      <td><input type="time" class="in"></td>
      <td><input type="time" class="out"></td>
      <td><input type="number" class="lunch" min="0"></td>
      <td><input class="hrs" readonly></td>`;
    timesheetBody.appendChild(tr);
  }
}

function submitTimesheet(){
  alert("Submission wired â€” data will be saved & emailed via Apps Script.");
}
</script>

</body>
</html>
